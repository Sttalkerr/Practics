# Практическое занятие №5.Вопросы виртуализации
## Задача 1. Исследование виртуальной стековой машины CPython. Изучите возможности просмотра байткода ВМ CPython.
```
11 0 LOAD_FAST 0 (x)
```
Эта команда загружает значение локальной переменной x в стек.
Эквивалентное выражение на Python: x
```
2 LOAD_CONST 1 (10)
```
Здесь загружается константа 10 в стек.
Эквивалентное выражение на Python: 10
```
4 BINARY_MULTIPLY
```
Умножает два значения на верхушке стека (значение из x и 10), результат будет помещен на верх стека.
Эквивалентное выражение на Python: x * 10
```
6 LOAD_CONST 2 (42)
```
Загружает константу 42 в стек.
Эквивалентное выражение на Python: 42
```
8 BINARY_ADD
```
Складывает два значения на верхушке стека (результат умножения x * 10 и 42) и помещает результат в стек.
Эквивалентное выражение на Python: x * 10 + 42
```
10 RETURN_VALUE
```
Эта команда возвращает значение, находящееся на верхушке стека, в качестве результата выполнения функции.
Эквивалентное выражение на Python: return (x * 10 + 42)

## Задача 2. Что делает следующий байткод (опишите шаги его работы)? Это известная функция, назовите ее.
Этот байткод реализует функцию для вычисления факториала числа n
```5 0 LOAD_CONST 1 (1)``` Загружает константу 1 в стек.

```2 STORE_FAST 1 (r)``` Сохраняет значение 1 в локальную переменную r. В данный момент r = 1.

```6 >> 4 LOAD_FAST 0 (n)``` Загружает значение переменной n в стек. Это текущее значение числа, для которого вычисляется факториал.

```6 LOAD_CONST 1 (1)``` Загружает константу 1 снова в стек.

```8 COMPARE_OP 4 (>)``` Сравнивает значение n с 1. Если n больше 1, выполняется переход к следующему шагу. Иначе, выполнение переходит к инструкции 30 для возврата r.

```10 POP_JUMP_IF_FALSE 30``` Если n не больше 1, то голова управления переходит к адресу 30 (к возврату результата).

```12 LOAD_FAST 1 (r) ```Загружает текущее значение r в стек.

```14 LOAD_FAST 0 (n)``` Загружает значение n в стек.

```16 INPLACE_MULTIPLY ```Умножает r на n (текущее значение) и сохраняет результат в r. Теперь r = r * n.

```20 LOAD_FAST 0 (n) ```Снова загружает значение n в стек.

```22 LOAD_CONST 1 (1)``` Загружает 1 в стек.

```24 INPLACE_SUBTRACT``` Вычитает 1 из n и обновляет n. Теперь n = n - 1.

```26 STORE_FAST 0 (n)``` Сохраняет обновленное значение n.

```28 JUMP_ABSOLUTE 4 ```Переходит к инструкции с адресом 4, что приводит к повторному проверке условия .

```30 >> LOAD_FAST 1 (r)``` После завершения цикла возвращает значение переменной r, которая содержит результат вычисления факториала.

```32 RETURN_VALUE``` Завершает выполнение и возвращает значение r.

## Задача 3. Приведите результаты из задач 1 и 2 для виртуальной машины JVM (Java) или .Net (C#).
```
public class Factorial {
    public static int factorial(int n) {
        int r = 1;
        while (n > 1) {
            r *= n;
            n--;
        }
        return r;
    }
}
```
## Задача 4. Работа с qemu. Скачать и установить ISO-образ Alpine Linux для виртуальных машин с официального сайта. Создать с помощью qemu образ жесткого диска (опция -f qcow2). Объем диска 500 Мб. Запустить Alpine Linux с CD-ROM. Установить систему на sda. Изменить motd. Загрузиться уже с sda. Прислать полный список команд для установки и загрузки, а также скриншот с motd, где фигурируют ваши имя и фамилия.
```
qemu-img create -f qcow2 alpine_disk.qcow2 500M
```
```
qemu-system-x86_64 -cdrom path/to/alpine.iso -hda alpine_disk.qcow2 -boot d -m 512
```
```
echo "Скляр Матвей" > /etc/motd
```
```
reboot
```
```
qemu-system-x86_64 -hda alpine_disk.qcow2 -boot c -m 512
```
